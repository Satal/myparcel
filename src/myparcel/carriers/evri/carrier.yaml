# Evri (formerly Hermes) Carrier Configuration
# https://www.evri.com/track/parcel/{tracking_number}
#
# Note: Evri's tracking page is a JavaScript SPA. The tracker requires
# Playwright for browser automation. Install with:
#   pip install playwright && playwright install chromium

id: evri
name: Evri
website: https://www.evri.com
tracking_url_template: "https://www.evri.com/track/parcel/{tracking_number}"
enabled: true

# Tracking number patterns
# Source: https://www.ship24.com/couriers/evri-tracking/evri-tracking-number
tracking_patterns:
  # Alphanumeric format: Letter + 2 digits + 13 alphanumeric (e.g., T00D7A9104600744)
  - regex: "^[A-Z][0-9]{2}[A-Z0-9]{13}$"
    description: "Evri alphanumeric format (letter + 2 digits + 13 chars)"

  # All-digit format: 16 digits (e.g., 1002345678912345)
  - regex: "^[0-9]{16}$"
    description: "Evri 16-digit numeric format"

  # 8-digit calling card number (left by courier if you weren't home)
  - regex: "^[0-9]{8}$"
    description: "Evri calling card number (8 digits)"

# Status mapping
status_mapping:
  "delivered": "delivered"
  "parcel delivered": "delivered"
  "left in safe place": "delivered"
  "handed to resident": "delivered"

  "out for delivery": "out_for_delivery"
  "with courier": "out_for_delivery"

  "on its way": "in_transit"
  "in transit": "in_transit"
  "at hub": "in_transit"
  "at depot": "in_transit"
  "at the delivery depot": "in_transit"
  "scanned": "in_transit"

  "collected": "received"
  "received": "received"
  "picked up": "received"

  "delivery attempted": "failed_attempt"
  "could not deliver": "failed_attempt"
  "no access": "failed_attempt"

  "at parcelshop": "held"
  "available for collection": "held"

  "returning": "returned"
  "returned": "returned"

# Email patterns
email_patterns:
  subject_contains:
    - "Evri"
    - "Hermes"
    - "Your parcel"
    - "Delivery update"
  # Matches: alphanumeric (T00...) or 16 digits or 8-digit calling card
  tracking_regex: "[A-Z][0-9]{2}[A-Z0-9]{13}|[0-9]{16}|[0-9]{8}"
